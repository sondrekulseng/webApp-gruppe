<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Bestill</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        body {
            margin: auto;
            width: 60%;
            margin-top: 1em;
        }

        .form-control {
            margin-bottom: 0.5em;
            width: 40%;
        }
    </style>
</head>
<body>
    <h3>Bestill billett</h3>
    <form class="form-group" id="frmBestill">
        <!-- Velg strekning -->
        <h4>Strekning</h4>
        <select id="velgStrekning" class="form-control"></select>
        <!-- Velg avreisedato -->
        <h4>Avreise</h4>
        <input type="date" class="form-control" id="velgDato" required />
        <!-- Kundeinfo -->
        <h4>Kunde info</h4>
        <input type="text" class="form-control" id="inpFornavn" placeholder="Fornavn" required />
        <input type="text" class="form-control" id="inpEtternavn" placeholder="Etternavn" required />
        <input type="email" class="form-control" id="inpEpost" placeholder="Epost" required />
        <input type="tel" class="form-control" id="inpTelefon" placeholder="Telefon" required />
        <button type="submit" class="btn btn-primary">Send bestilling</button>
    </form>

    <script>
        $.get("Strekning/hent", function (data) {
            console.log(data);
            for (let i = 0; i < data.length; i++) {
                $("#velgStrekning").append(`<option>${data[i].strekning}, ${data[i].pris} kr</option>`);
            }
        });

        document.getElementById("frmBestill").onsubmit = function (evt) {
            evt.preventDefault();

            const bestilling = {
                fornavn: $("#inpFornavn").val(),
                etternavn: $("#inpEtternavn").val(),
                epost: $("#inpEpost").val(),
                telefon: $("#inpTelefon").val(),
                avreiseDato: $("#velgDato").val(),
                strekningID: document.getElementById("velgStrekning").selectedIndex
            };

            $.post("Bestilling/lagre", bestilling, function () {
            });
        }
    </script>
</body>
</html>

